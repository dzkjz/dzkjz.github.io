<html>

<head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>
    JojoLegend
</title>
<link rel="shortcut icon" href="https://dzkjz.github.io//favicon.ico?v=1599142463286">
<!-- <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous"> -->
<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://dzkjz.github.io//styles/main.css">
<!-- js -->
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<script src="https://dzkjz.github.io//media/js/jquery.sticky-sidebar.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>


</head>

<body>
    <div class="main">
        <div class="header">
    <div class="nav">
        <div class="logo">
            <a href="https://dzkjz.github.io/">
                <img class="avatar" src="https://dzkjz.github.io//images/avatar.png?v=1599142463286" alt="">
            </a>
            <div class="site-title">
                <h1>
                    JojoLegend
                </h1>
            </div>
        </div>
        <span class="menu-btn fa fa-align-justify"></span>
        <div class="menu-container">
            <ul>
                
                    
                            <li>
                                <a href="/" class="menu">
                                    首页
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/archives" class="menu">
                                    归档
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/tags" class="menu">
                                    标签
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/post/about" class="menu">
                                    关于
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/vue" class="menu">
                                    Vue
                                </a>
                            </li>
                            
                                
            </ul>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {
        $(".menu-btn").click(function() {
            $(".menu-container").slideToggle();
        });
        $(window).resize(function() {

            if (window.matchMedia('(min-width: 960px)').matches) {
                $(".menu-container").css('display', 'block')
            } else {
                $(".menu-container").css('display', 'none')
            }

        });
    });
</script>

            <div id="main-content" class="post-container main-container">
                <div id="content" class="main-container-left">
                    
        
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://dzkjz.github.io/post/laravel-database-migrations-xue-xi-ti-gang/">
                        Laravel Database Migrations学习提纲
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2020-09-03</time>
                    
                </div>
                <div class="post-article">
                    
                            <div class="post-content">
                                
                                        <div class="post-content-content">
                                            
带着问题学，文档里介绍的功能在什么情况下使用？这些功能有什么用？具体使用方法直接查看官方文档！

Migrations就类似于数据包的版本控制。
Creating Columns 创建列
Column Modifiers 修饰列
Modifying Columns 修改列
Dropping Columns删除列
Indexes
$table-&amp;gt;id()-&amp;gt;unique();
$table-&amp;gt;primary(&#39;id&#39;);
$table-&amp;gt;spatialIndex(&#39;location&#39;);//除了sqlite以外的都支持
$table-&amp;gt;primary([&#39;id&#39;, &#39;parent_id&#39;]);
$table-&amp;gt;unique(&#39;email&#39;);
$table-&amp;gt;index([&#39;account_id&#39;, &#39;created_at&#39;]);
$table-&amp;gt;unique(&#39;email&#39;,
    &#39;unique_email&#39;// specify the index name yourself
);
$table-&amp;gt;renameIndex(&#39;from&#39;, &#39;to&#39;);


Foreign Key Constraints
//外键【一个表[users表]上的键[id]出现在别的表[orders表]上，就是外键[user_id]】添加
$table-&amp;gt;foreign(&#39;user_id&#39;)-&amp;gt;references(&#39;id&#39;)-&amp;gt;on(&#39;users&#39;);


//作用同上
$table-&amp;gt;foreignId(&#39;user_id&#39;)//unsignedBigInteger别名
-&amp;gt;constrained();


$table-&amp;gt;foreignId(&#39;user_id&#39;)//unsignedBigInteger别名
-&amp;gt;constrained(&#39;users&#39;)//可以指定表名
-&amp;gt;onDelete(&#39;cascade&#39;)//预期行为
;


$table-&amp;gt;foreignId(&#39;user_id&#39;)//unsignedBigInteger别名
-&amp;gt;nullable()//可在constrained前调用
-&amp;gt;constrained();


$table-&amp;gt;dropForeign(&#39;posts_user_id_foreign&#39;);//删除外键[存放在posts表中的user_id外键]

//也可以
$table-&amp;gt;dropForeign([&#39;user_id&#39;]);


//启动外键约束
// SQLite disables foreign key constraints by default.
// When using SQLite, make sure to enable foreign key support in your
// database configuration before attempting to create them in your migrations.
// In addition, SQLite only supports foreign keys upon creation of the table and not when tables are altered.
Schema::enableForeignKeyConstraints();

//取消外键约束
Schema::disableForeignKeyConstraints();


                                        </div>
                                        
                                            <a class="btn btn-text" href="https://dzkjz.github.io/post/laravel-database-migrations-xue-xi-ti-gang/">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://dzkjz.github.io/post/laravel-database-pagination-xue-xi-ti-gang/">
                        Laravel Database Pagination学习提纲
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2020-09-03</time>
                    
                </div>
                <div class="post-article">
                    
                            <div class="post-content">
                                
                                        <div class="post-content-content">
                                            
带着问题学，文档里介绍的功能在什么情况下使用？这些功能有什么用？具体使用方法直接查看官方文档！

默认情况下，分页的当前页码是在http的请求字符串page里的，后端会自动检测到，当然也会由分页器自动给插入到前端。
$users = DB::table(&#39;users&#39;)-&amp;gt;paginate(15);
if ($users) {
    return view(&#39;user.index&#39;, [&#39;users&#39; =&amp;gt; $users]);
}
//分页数据对于groupBy方法结果不太支持【目前】，如果确有需要，请自己实现

$users = DB::table(&#39;users&#39;)-&amp;gt;simplePaginate(15);//前端只需要后一页，前一页的链接数据，而不是分页结果里每一页的链接地址数据


$users = \App\Models\User::paginate(15);

$users = \App\Models\User::where(&#39;votes&#39;, &#39;&amp;gt;&#39;, 100)-&amp;gt;paginate(15);

$users = \App\Models\User::where(&#39;votes&#39;, &#39;&amp;gt;&#39;, 100)-&amp;gt;simplePaginate(15);


//自定义分页器
// Illuminate\Pagination\Paginator[对应simplePaginate方法]
// or
// Illuminate\Pagination\LengthAwarePaginator【对应有paginate方法】


View部分，如果使用laravel的前端，可以查看Customizing The Pagination View详细了解。以及前端的blade模板自定义，blade中paginator方法的调用Paginator Instance Methods。


                                        </div>
                                        
                                            <a class="btn btn-text" href="https://dzkjz.github.io/post/laravel-database-pagination-xue-xi-ti-gang/">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://dzkjz.github.io/post/laravel-database-query-builder-xue-xi-ti-gang/">
                        Laravel Database Query Builder学习提纲
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2020-09-03</time>
                    
                </div>
                <div class="post-article">
                    
                            <div class="post-content">
                                
                                        <div class="post-content-content">
                                            
*带着问题学，文档里介绍的功能在什么情况下使用？这些功能有什么用？具体使用方法直接查看官方文档！


The Laravel query builder uses PDO parameter binding to protect your application against SQL injection attacks. There is no need to clean strings being passed as bindings.

//Retrieve single Row
$user = DB::table(&#39;users&#39;)-&amp;gt;where(&#39;name&#39;, &#39;John&#39;)-&amp;gt;first();
echo $user-&amp;gt;name;

//Retrieve single row data&#39;s column value
$email = DB::table(&#39;users&#39;)-&amp;gt;where(&#39;name&#39;, &#39;John&#39;)-&amp;gt;value(&#39;email&#39;);

//Retrieve By ID
$user = DB::table(&#39;users&#39;)-&amp;gt;find(3);


//Retrieve a list of column values
$titles = DB::table(&#39;roles&#39;)-&amp;gt;pluck(&#39;title&#39;);
foreach ($titles as $title) {
    echo $title;
}

//
$roles = DB::table(&#39;roles&#39;)-&amp;gt;pluck(&#39;title&#39;, &#39;name&#39;);
foreach ($roles as $name =&amp;gt; $title) {
    echo $title;
}

//一次取一部分数据，分块获取，每一小块还可放进闭包里处理
DB::table(&#39;users&#39;)-&amp;gt;orderBy(&#39;id&#39;)-&amp;gt;chunk(100, function ($users) {
    foreach ($users as $user) {
        //
    }
});

DB::table(&#39;users&#39;)-&amp;gt;orderBy(&#39;id&#39;)-&amp;gt;chunk(100, function ($users) {
    //处理数据

    return false;//返回false表示停止处理然后退出返回
});


//如果你需要在闭包里处理及更新数据，一遍更新，一边取，如果是按修改时间取，那你修改了的就一直是最新，就一直在修改这一段，
//这个时候，建议使用chunkById方法，会依据数据的primary key排序
DB::table(&#39;users&#39;)-&amp;gt;where(&#39;active&#39;, false)
    -&amp;gt;chunkById(100, function ($users) {
        foreach ($users as $user) {
            DB::table(&#39;users&#39;)-&amp;gt;where(&#39;id&#39;, $user-&amp;gt;id)-&amp;gt;update([&#39;active&#39; =&amp;gt; true]);
        }
    });

//不过还需要注意，如果你的操作是增加或者删除数据，任何对primary key或者外键的修改，会影响chunk query结果。

/** Aggregates */
// count, max, min, avg, sum

$users = DB::table(&#39;users&#39;)-&amp;gt;count();

$price = DB::table(&#39;orders&#39;)-&amp;gt;max(&#39;price&#39;);

$price = DB::table(&#39;orders&#39;)
    -&amp;gt;where(&#39;finalized&#39;, 1)
    -&amp;gt;avg(&#39;price&#39;);

$exists = DB::table(&#39;orders&#39;)-&amp;gt;where(&#39;finalized&#39;, 1)-&amp;gt;exists();
$notExists = DB::table(&#39;orders&#39;)-&amp;gt;where(&#39;finalized&#39;, 1)-&amp;gt;doesntExist();

/** Selects */
$users = DB::table(&#39;users&#39;)-&amp;gt;select(&#39;name&#39;, &#39;email as user_email&#39;)-&amp;gt;get();

//唯一值
$users = DB::table(&#39;users&#39;)-&amp;gt;distinct()-&amp;gt;get();

//追加select限定
$query = DB::table(&#39;users&#39;)-&amp;gt;select(&#39;name&#39;);
$users = $query-&amp;gt;addSelect(&#39;age&#39;)-&amp;gt;get();

//原生 表达式
$users = DB::table(&#39;users&#39;)
    -&amp;gt;select(DB::raw(&#39;count(*) as user_count,status&#39;))//原生语句会以字符串的形式注入到sql query种，一定要避免sql注入
    -&amp;gt;where(&#39;status&#39;, &#39;&amp;lt;&amp;gt;&#39;, 1)
    -&amp;gt;groupBy(&#39;status&#39;)
    -&amp;gt;get();

//selectRaw
$orders = DB::table(&#39;orders&#39;)
    -&amp;gt;selectRaw(&#39;price * ? as price_with_tax&#39;, [1.0825])//接受第二个参数作为第一语句中&#39;?&#39;的绑定值
    -&amp;gt;get();

DB::table(&#39;orders&#39;)
    -&amp;gt;whereRaw(&#39;price &amp;gt; IF(state = &amp;quot;TX&amp;quot;,?,100)&#39;, [200])
    -&amp;gt;get();

DB::table(&#39;orders&#39;)-&amp;gt;select(&#39;department&#39;, DB::raw(&#39;SUM(price) as total_sales&#39;))
    -&amp;gt;groupBy(&#39;department&#39;)
    -&amp;gt;havingRaw(&#39;SUM(price)&amp;gt;?&#39;, [2500]) //haveRaw和orHavingRaw方法可用于将原始字符串设置为having子句的值
    -&amp;gt;get();


//orderByRaw方法可用于将原始字符串设置为order by子句的值：
DB::table(&#39;orders&#39;)-&amp;gt;orderByRaw(&#39;updated_at - created_at DESC&#39;)-&amp;gt;get();

//groupByRaw方法可用于将原始字符串设置为group by子句的值：
DB::table(&#39;orders&#39;)-&amp;gt;select(&#39;city&#39;, &#39;state&#39;)-&amp;gt;groupByRaw(&#39;city,state&#39;)-&amp;gt;get();


//Joins
//Unions
//Where Clauses
//Ordering, Grouping, Limit &amp;amp; Offset
//Conditional Clauses
$role = $request-&amp;gt;input(&#39;role&#39;);
DB::table(&#39;users&#39;)
    -&amp;gt;when($role, function ($query, $role) {
        $query-&amp;gt;where(&#39;role_id&#39;, $role);
    })-&amp;gt;get();
//Inserts
//Updates
//Deletes
//Pessimistic Locking
//Debugging


                                        </div>
                                        
                                            <a class="btn btn-text" href="https://dzkjz.github.io/post/laravel-database-query-builder-xue-xi-ti-gang/">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://dzkjz.github.io/post/laravel-database-xue-xi-ti-gang/">
                        Laravel Database学习提纲
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2020-09-03</time>
                    
                </div>
                <div class="post-article">
                    
                            <div class="post-content">
                                
                                        <div class="post-content-content">
                                            
*带着问题学，文档里介绍的功能在什么情况下使用？这些功能有什么用？具体使用方法直接查看官方文档！

Laravel支持多种SQL数据库，如果需要查看每个数据库怎么配置，请查看官方文档Configuration
使用了多个数据库链接的情况下，如果要指定选其中一个链接来处理，可以参考Using Multiple Database Connections

DB facade支持的增删改查方法，详细的请看官方文档Running Raw SQL Queries

Listening For Query Events
每个SQL请求都会触发事件，如果需要log这些query或者debug，可以使用DB::listen方法。

详细请看Listening For Query Events

数据库事务Database Transactions
$users = DB::connection(&#39;mysql&#39;)-&amp;gt;select(&#39;&#39;);

//获取底层的pdo实例
$pdo = DB::connection()-&amp;gt;getPdo();

// The select method will always return an array of results.
// Each result within the array will be a PHP stdClass object,
// allowing you to access the values of the results:
$users = DB::select(&#39;select * from users where active = ?&#39;, [1]);
if ($users) {
    return view(&#39;user.index&#39;, [&#39;users&#39; =&amp;gt; $users]);
}

foreach ($users as $user) {
    echo $user-&amp;gt;name;
}

//Naming bindings

$results = DB::select(&#39;select * from users where id =:id&#39;, [&#39;id&#39; =&amp;gt; 1]);


//insert
DB::insert(&#39;insert into users(id,name) values(?,?)&#39;, [1, &#39;Dayle&#39;]);

//update
$affected = DB::update(&#39;update users set votes = 100 where name= ? &#39;, [&#39;John&#39;]);


//delete
$deleted = DB::delete(&#39;delete from users&#39;); // the number of rows affected will be returned:


//statement
// Some database statements do not return any value.
// For these types of operations, you may use the statement method on the DB facade:
DB::statement(&#39;drop table users&#39;);


//Database Transactions 数据库事务，闭包内事务如果执行异常，会自动回滚处理，如果成功，事务就会自动完成执行
DB::transaction(function () {
    DB::table(&#39;users&#39;)-&amp;gt;update([&#39;votes&#39; =&amp;gt; 1]);
    DB::table(&#39;posts&#39;)-&amp;gt;delete();
});


DB::transaction(function () {
    DB::table(&#39;users&#39;)-&amp;gt;update([&#39;votes&#39; =&amp;gt; 1]);
    DB::table(&#39;posts&#39;)-&amp;gt;delete();
}, 5);//第二个参数作用，如果出现死锁，会最大尝试5次，超次就会抛异常

//手动启动事务执行
DB::beginTransaction();
//手动回滚
DB::rollBack();
//手动提交事务
DB::commit();


                                        </div>
                                        
                                            <a class="btn btn-text" href="https://dzkjz.github.io/post/laravel-database-xue-xi-ti-gang/">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://dzkjz.github.io/post/laravel-task-scheduling-xue-xi-ti-gang/">
                        Laravel Task Scheduling学习提纲
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2020-09-02</time>
                    
                </div>
                <div class="post-article">
                    
                            <div class="post-content">
                                
                                        <div class="post-content-content">
                                            
带着问题学，文档里介绍的功能在什么情况下使用？这些功能有什么用？具体使用方法直接查看官方文档！

Schedule就是用来简化Cron操作的。

初始配置查看 Introduction


执行Artisan command，queue job，shell命令，闭包方法，以及执行时间间隔，频率，执行所处的时间段等详细资料查看官方文档Defining Schedules。

如果你的应用放置在三个服务器上，你的计划调度就会三个服务器同时启动，只需要一个调度完成的任务，三个都在调度，这样明显不好，应该限制只在一个机器上运行就可以了。使用onOneServer方法。

详细参考Running Tasks On One Server

如果有多个命令依序执行，有几个超耗时的命令排在前面，那后面的命令可能就一直卡很久，都不能按计划时间执行，这时候应该把这些命令改成后台执行，这样它们就能同步执行了。

详细参考Background Tasks

如果你的应用进入维护模式，这个时候Scheduled任务是不会运行的，但是如果你不想某些任务受到维护模式影响而不能运行，使用 evenInMaintenanceMode方法；

详细参考：Maintenance Mode

Task Output
//输出到文件
$filePath = &#39;&#39;;
$schedule-&amp;gt;command(&#39;emails:send&#39;)
    -&amp;gt;daily()
    -&amp;gt;sendOutputTo($filePath);

//追加到文件
$schedule-&amp;gt;command(&#39;emails:send&#39;)
    -&amp;gt;daily()
    -&amp;gt;appendOutputTo($filePath);

//如果配置好了email发送服务
//可以把输出发送到指定邮箱
$schedule-&amp;gt;command(&#39;foo&#39;)
    -&amp;gt;daily()
    -&amp;gt;sendOutputTo($filePath)
    -&amp;gt;emailOutputTo(&#39;foo@example.com&#39;);

//只把错误信息发到指定邮箱
$schedule-&amp;gt;command(&#39;foo&#39;)
    -&amp;gt;daily()
    -&amp;gt;emailOutputOnFailure(&#39;foo@example.com&#39;);


独有的方法：
The emailOutputTo, emailOutputOnFailure, sendOutputTo, and appendOutputTo methods are exclusive to the command and exec methods.

Task Hooks
//可以在任务执行前后安插逻辑
$schedule-&amp;gt;command(&#39;emails:send&#39;)
    -&amp;gt;daily()
    -&amp;gt;before(function () {
        // Task is about to start...
    })-&amp;gt;after(function () {
        // Task is complete...
    });

//可以在任务成功和失败后安插逻辑
$schedule-&amp;gt;command(&#39;emails:send&#39;)
    -&amp;gt;daily()
    -&amp;gt;onSuccess(function () {
        // The task succeeded...
    })-&amp;gt;onFailure(function () {
        // The task is failed...
    });


$url = &#39;&#39;;
//可以在任务执行前或完成后ping一个URL
$schedule-&amp;gt;command(&#39;emails:send&#39;)
    -&amp;gt;daily()
    -&amp;gt;pingBefore($url)
    -&amp;gt;thenPing($url);

//条件为真才ping
$condition = true;
$schedule-&amp;gt;command(&#39;emails:send&#39;)
    -&amp;gt;daily()
    -&amp;gt;pingBeforeIf($condition, $url)
    -&amp;gt;thenPingIf($condition, $url);


//任务执行成功或失败后ping url
$schedule-&amp;gt;command(&#39;emails:send&#39;)
    -&amp;gt;daily()
    -&amp;gt;pingOnSuccess($url)
    -&amp;gt;pingOnFailure($url);


上面所有的ping 方法需要安装Guzzle Http包;
执行 composer require guzzlehttp/guzzle安装


                                        </div>
                                        
                                            <a class="btn btn-text" href="https://dzkjz.github.io/post/laravel-task-scheduling-xue-xi-ti-gang/">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://dzkjz.github.io/post/laravel-queues-xue-xi-ti-gang/">
                        Laravel Queues学习提纲
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2020-09-02</time>
                    
                </div>
                <div class="post-article">
                    
                            <div class="post-content">
                                
                                        <div class="post-content-content">
                                            
带着问题学，文档里介绍的功能在什么情况下使用？这些功能有什么用？具体使用方法直接查看官方文档！

如果你有特别消耗时间的任务的时候，比如发送邮件，这时候用queue延迟一下发送操作，对于你的应用来说，可以急剧的提升请求速度。【用户点发送按钮，然后加入queue，整个应用不会因为卡在发送email过程而长时间等待，而是直接返回给用户，这样用户体验比较好】
如果你的应用在使用queue的时候，需要指定多个queue处理任务，比如一个queue用来存，一个用来发sms，一个用来做点其他的，那么可以给每个queue设置权重，权重越高的越先处理。参考 Connections Vs. Queues最后一段文本。
queue.php中的驱动配置可以参考Driver Notes &amp;amp; Prerequisites
Creating Jobs
Job用来被queue延迟执行的，主要是handle方法。
job一般是这样dispatch触发：dispatch就是加入到queue中；

传入job的model会被序列化，

而queue最后管理调用job的handle方法，执行处理。

详细查看 Class Structure 以及 Job Middleware

Dispatching Jobs
触发job查看官方文档。
如果要处理一个比如，发送邮件完毕且响应传回后才执行的job，可以使用

这两个方法；
如果不需要加入到queue而是需要立即处理掉job：

如果需要执行一列跟随任务：
参考Job Chaining，比如

当然也可以在chain里加入闭包执行。

job即使使用$this-&amp;gt;delete()删除，也不会阻止chained的job被执行，除非job chain里面有fail。

chain的jobs也可以指定connection和queue驱动执行，当然，如果chain里面的job显式指定过queue或者connection，那么该job会使用其指定的queue或connection。

如果需要对job做等待超时，执行超时，超次限制，频率限制，请查看 Specifying Max Job Attempts / Timeout Values

如果一个queued的job正在修改一个资源，但是这个资源同时只能有一个job去修改编辑，那么需要限制最大的工作job进程。

请使用funnel做限制 ，参考Rate Limiting

需要注意的是，做了这么多限制之后，执行成功到底需要多少次尝试就很难判断了，因此，结合一个延时设置【 time based attempts】会比较有用。
Queueing Closures
不想写job，或者job比较简单，可以直接queue一个闭包，逻辑写闭包里面就行。
Running The Queue Worker
php artisan queue:work

执行启动了queue之后，会一直在后台执行，但是代码的任何修改，work不会有反应，所以部署后，记得重启一下。
不过php artisan queue:listen可以侦听代码变化，不用重启queue，但是listen没有work高效。
php artisan queue:work redis --queue=emails

redis就是指定的queue connection，emails就是指定的queue。
更多的queue 命令行操作参数比如权重，单次处理，停止，参考Running The Queue Worker
请注意：

The queue uses the cache to store restart signals, so you should verify a cache driver is properly configured for your application before using this feature.

Job Expirations &amp;amp; Timeouts
在您的config / queue.php配置文件中，每个队列连接定义一个retry_after选项。
该选项指定队列连接在重试正在处理的作业之前应等待的秒数。
例如，如果retry_after的值设置为90，则该job如果已处理90秒但未删除，则将其释放回到队列中。
Supervisor Configuration
如果有需要配置Supervisor，参考这个Supervisor Configuration
Dealing With Failed Jobs
失败job重试，失败job记录到数据表，失败job清理，侦听失败job触发的事件，
如果传入job中的Eloquent模型在job被processing前删除了，job会抛出异常 ModelNotFoundException，默认可以在job类中的处理，参考Ignoring Missing Models
Job Events
如果需要在queue job执行前后做一些logging或者状态的编辑记录，可以参考Job Events，主要是queue facade的before和after方法的调用，以及一个传入JobProcessing或JobProcessed类型事件参数的闭包。
还可以在worker尝试从queue中取一个job之前，执行一些逻辑。每次取之前都会执行。

                                        </div>
                                        
                                            <a class="btn btn-text" href="https://dzkjz.github.io/post/laravel-queues-xue-xi-ti-gang/">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://dzkjz.github.io/post/laravel-package-development-xue-xi-ti-gang/">
                        Laravel Package Development学习提纲
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2020-09-02</time>
                    
                </div>
                <div class="post-article">
                    
                            <div class="post-content">
                                
                                        <div class="post-content-content">
                                            
带着问题学，文档里介绍的功能在什么情况下使用？这些功能有什么用？具体使用方法直接查看官方文档！

开发包主要是给Laravel提供功能。

有些大佬开发的包，是独立的，任何PHP 框架都可以用，
有的包就必须在Laravel框架才能用，包里可能有routes controllers views 以及configuration之类的，包只是针对Laravel功能的。
Laravel中使用的时候，就是设置在composer.json文件中；

扩展包里的servicer provider除了用户手动注册在app.php的providers里面，还可以参考Package Discovery自动处理。
开发包如果有以下的部分，代码写完后，如何配置和发布可以参考：

Resources
Configuration
Migrations
Factories
Routes
Translations
Views
View Components
Commands
Public Assets
Publishing File Groups


                                        </div>
                                        
                                            <a class="btn btn-text" href="https://dzkjz.github.io/post/laravel-package-development-xue-xi-ti-gang/">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://dzkjz.github.io/post/laravel-notifications-xue-xi-ti-gang/">
                        Laravel Notifications学习提纲
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2020-09-01</time>
                    
                </div>
                <div class="post-article">
                    
                            <div class="post-content">
                                
                                        <div class="post-content-content">
                                            
带着问题学，文档里介绍的功能在什么情况下使用？这些功能有什么用？具体使用方法直接查看官方文档！

Notification主要用来发送简洁的通知，告知，比如付款成功之类的，Laravel支持mail，SMS，Slack方式的推送通知给用户。而且因为Notification也可用来显示在web页面上，所以Notification也可以被存在数据库中。

创建通知参考Creating Notifications

Model类如果需要支持被通知，那请使用Notifiable trait，不只User model可以支持，只要需要，就可以用这个trait。

使用方法参考Using The Notifiable Trait

如果是发送给一组用户或者被通知的Model实例组，那可以使用Notification facade的send方法。

使用方法具体参考Using The Notification Facade

因为Notifications发送时需要消耗时间的，特别是还要调用外部API来发送的场景下，那么请启用Queue；【就是 implements the ShouldQueue，但是使用还是和平常一样】

具体参考Queueing Notifications

因为Notification的via方法是支持返回一组数组--如[&#39;mail&#39;,&#39;slack&#39;]
就是这个通知发送将使用[&#39;mail&#39;,&#39;slack&#39;]两个渠道，而使用queue来处理发送的时候，可以针对这两个渠道，分别指定不同的queue处理。

具体参考Queueing Notifications的Customizing Notification Channel Queues部分

如果需要搞一个按需通知，可以使用Notification::route方法。

具体参考On-Demand Notifications

如果需要更改Mail Notification的Header和Footer的name值，请在config/app.php中设置name；

如果需要了解怎么写一个Notification Email 以及更多的方法 请参考Mail Notifications


如果需要自定义Mail Notification或有更多的配置需求，可以查看
Customizing The Sender
Customizing The Recipient
Customizing The Subject
Customizing The Mailer
如果需要对默认给的Notification邮件模板做一些自定义修改，参考Customizing The Templates
如果需要预览Notification Mail，可以参考Previewing Mail Notifications
每个就是一个方法的讲解而已。很简单

Markdown Mail Notifications
和Mail Notification差不多，只是不再使用action或者line方法调用来生成邮件内容，而是一个markdown方法调用。

具体参考 Generating The Message

而如果要修改邮件内容，就需要前面修改编辑markdown文件了；

如何使用参考  Writing The Message


而每一个组件的修改编辑参考Customizing The Components，其实之前学习Email的时候，也是这个；

Database Notifications
主要是notification如果需要显示在页面上，这样就会用到database。比如用户登录了，就在dashbroad页面给显示notifications。
参考Prerequisites，先执行：
php artisan notifications:table

php artisan migrate

生成notification的数据表。

定义被存储下来的数据，请参考Formatting Database Notifications


存储下来的notifications数据，要展示出来的时候，请参考Accessing The Notifications


现实使用的时候，可以添加一个Notification Controller，这样要从js客户端访问这个notifiable实体【比如当前user】的notifications数据的时候，可以从js客户端向后端的这个controller执行一个HTTP请求获取。


其他的标注已读，批量标注已读，批量更新，批量删除，请查阅Marking Notifications As Read

Broadcast Notifications
这个用就很牛了，可以做成聊天室式的广播告知【游戏里的大喇叭式，全站送礼物通知】。前端后端都需要参考Broadcasting做一些设置。
SMS Notifications
如果有需要搞一个短信通知，那可以参考这个官方文档SMS Notifications做一些设置和修改。
Slack Notifications
Slack可以用到协同办公和公共留言板之类的，支持很多app，如果需要这个可以看看官方文档如何配置。
Localizing Notifications
语言本地化；
Notification Events
在notification被发送后，会触发相关的事件，如果需要了解，请参考官方文档
Custom Channels
Laravel以及提供了很多Notification发送的信道，如果还有更多需求来传输你的Notification，那么可以参考此部分文档：Custom Channels。

                                        </div>
                                        
                                            <a class="btn btn-text" href="https://dzkjz.github.io/post/laravel-notifications-xue-xi-ti-gang/">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://dzkjz.github.io/post/laravel-mail-xue-xi-ti-gang/">
                        Laravel Mail学习提纲
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2020-09-01</time>
                    
                </div>
                <div class="post-article">
                    
                            <div class="post-content">
                                
                                        <div class="post-content-content">
                                            
带着问题学，文档里介绍的功能在什么情况下使用？这些功能有什么用？具体使用方法直接查看官方文档！

Mail不用说，就是发邮件的时候使用，那么官方文档里介绍的功能，就应该主要思考，发邮件需要什么功能的时候才能够用上？
而这种场景下要用的功能，具体怎么配置，使用方法就不介绍，需要的时候参阅官方文档。 主要思考的是使用场景，而不是使用方法。
Driver
如果需要的是更加简便快捷的Email发送服务器，比SMTP更快的，那就是API式的服务器，比如MailGun或者Postmark。

Mailgun和Postmark的配置使用参考Driver Prerequisites

如果需要Amazon SES驱动可以参考Driver Prerequisites
Mailables

Laravel发出的Email，就是被叫做可邮件化的类。
需要生成这个类，请参考Generating Mailables
具体如何编辑这个类，请参考Writing Mailables

如果需要在邮件发送前，再执行某些自定义修改，可以使用withSwiftMessage方法。
MarkDown Mailables

直接有预置模板，而且同时可以生成响应式HTML模板和对应的纯文本邮件内容。使用参考Markdown Mailables


Markdown可邮递类，结合了Blade组件和Markdown语法。
特别需要注意的是，Markdown解析器会把缩进给解析为代码块，所以不要CTRL+SHIFT+L做代码格式化。

预制的button组件，Panel组件，Table组件等直接开箱可用，需要了解可以参考 Writing Markdown Messages
很多情况下，邮件要做个自定义的样式，那么参考Customizing The Components
有需要queue 发送Mail的，可以参考Queueing Mail
如果需要不发出邮件但是查看以文本样式渲染出来的Mail，可以参考Rendering Mailables
测试发送邮件，如果不是发送到真地址来看效果，可以使用log 邮件驱动，把邮件发出存到log文件里面；或者在mail.php文件中设置一个全局的to地址，或者使用Mailtrap，这个也是比较建议的。
Events
邮件的发送会触发一系列的事件，详细参考Events

                                        </div>
                                        
                                            <a class="btn btn-text" href="https://dzkjz.github.io/post/laravel-mail-xue-xi-ti-gang/">Read More ~</a>
                            </div>
                </div>
            </article>
            
            <article class="post i-card">
                <h2 class="post-title">
                    <a href="https://dzkjz.github.io/post/laravel-http-client-xue-xi-ti-gang/">
                        Laravel HTTP Client 学习提纲
                    </a>
                </h2>
                <div class="post-info">
                    <time class="post-time">2020-09-01</time>
                    
                </div>
                <div class="post-article">
                    
                            <div class="post-content">
                                
                                        <div class="post-content-content">
                                            
带着问题学，文档里介绍的功能在什么情况下使用？这些功能有什么用？具体使用方法直接查看官方文档！

如果有需要向外发送HTTP请求，因为Laravel包裹了Guzzle，可以执行HTTP请求处理。不过需要提前执行composer require guzzlehttp/guzzle安装。
对于包含的guzzle请求，响应结果处理，异常处理，和发送方法，以及Http使用fake方法测试及asset断言，都参考官方文档

                                        </div>
                                        
                                            <a class="btn btn-text" href="https://dzkjz.github.io/post/laravel-http-client-xue-xi-ti-gang/">Read More ~</a>
                            </div>
                </div>
            </article>
            
                <!-- 翻页 -->
                
    <div class="pagination-container">
        
                
                    <a href="https://dzkjz.github.io/page/2" class="page-btn btn">下一页</a>
                    
    </div>
    
                </div>
                <!--  -->
                <div class="main-container-middle"></div>
                <!--  -->
                <div id="sidebar" class="main-container-right">

                    <!-- 个人信息 -->
                    
    <div class="id_card i-card">
        <div class="id_card-avatar" style="background-image: url(https://dzkjz.github.io//images/avatar.png?v=1599142463286)">
        </div>
        <h1 class="id_card-title">
            JojoLegend
        </h1>
        <h2 class="id_card-description">
            Something for age
        </h2>
        <!--  -->
        <div class="id_card-sns">
            <!-- github -->
            
                    <!-- twitter -->
                    
                            <!-- weibo -->
                            
                                    <!-- facebook -->
                                    

        </div>
    </div>
    

                        <!-- 公告栏 -->
                        

                </div>
            </div>



            <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | 
  <a class="rss" href="https://dzkjz.github.io//atom.xml" target="_blank">RSS</a>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>

    </div>
    <script>
        $('#sidebar').stickySidebar({
            topSpacing: 80,
            // bottomSpacing: 60
        });
    </script>
</body>

</html>